{
    "DAG_etl_ls": {
        "schedule_interval": "30 7 * * *",
        "retries": 2,
        "retry_delay": 15,
        "dagrun_timeout": 30,
        "project_vars": "mts-default-portofolio",
        "project_number": "42887123198",
        "region": "us-east1",
        "bigquery_sql": {
            "merge_delivery": {
                "query": {
                    "query": "CALL `{VAR_PRJ_NAME}.ls_customers.sp_merge_delivery_status`();",
                    "priority": "BATCH",
                    "useLegacySql": false,
                    "dependOnPast": false
                }
            },
            "delete_delivery_status": {
                "query": {
                    "query": "CALL `{VAR_PRJ_NAME}.staging.sp_delete_delivery_status`();",
                    "priority": "BATCH",
                    "useLegacySql": false,
                    "dependOnPast": false
                }

            }
        },
        "cloud_functions": {
            "cf-customers": {
                "cloud_function_url": "https://{VAR_CF_NAME}-{VAR_PRJ_NUMBER}.us-east1.run.app",
                "cloud_function_dict": {
                    "project_id": "mts-default-portofolio",
                    "secret_id": "bq_customers_access_authorization"
                }
            },
            "cf-products-inventory": {
                "cloud_function_url": "https://{VAR_CF_NAME}-{VAR_PRJ_NUMBER}.us-east1.run.app",
                "cloud_function_dict": {
                    "project_id": "mts-default-portofolio",
                    "secret_id": "bq_products_access_authorization"
                }
            },
            "cf-delivery-sensor": {
                "cloud_function_url": "https://{VAR_CF_NAME}-{VAR_PRJ_NUMBER}.us-east1.run.app",
                "cloud_function_dict": {
                    "project_id": "mts-default-portofolio",
                    "secret_id": "ps_delivery_sensor_access_authorization"
                }
            },
            "cf-wh-sensor": {
                "cloud_function_url": "https://{VAR_CF_NAME}-{VAR_PRJ_NUMBER}.us-east1.run.app",
                "cloud_function_dict": {
                    "project_id": "mts-default-portofolio",
                    "secret_id": "ps_wh_sensor_access_authorization"
                }
            }
        },
        "dataproc_tables": {
            "tb_order": {
                "spark_job_name": "spark_job_tb_order",
                "args": ["--project_id", "mts-default-portofolio",
                          "--dataset_id", "ls_customers",
                          "--num_purchases", "200000",
                          "--job_id"
                        ],
                "jar_file_uris": null
            },
            "tb_feedback": {
                "spark_job_name": "spark_job_tb_feedback",
                "args": ["--project_id", "mts-default-portofolio",
                      "--dataset_id", "ls_customers",
                      "--dataset_write_id", "production",
                      "--num_feedbacks", "75000",
                      "--job_id"
                    ],
                "jar_file_uris": null
            }
        },
        "dataproc_config": {
            "region": "us-east1",
            "project_id": "mts-default-portofolio",
            "cluster_name": "mts-cluster-dataproc",
            "secret_id": "dataproc_access_authorization",
            "cluster_config": {
                "config_bucket": "bkt-mts-dataproc",
                "gce_cluster_config": {
                    "tags": [
                        "coord-cd53-ae-vd",
                        "gerencia-gd13-analytics-eng-vd",
                        "projeto-exploracao-dados-vd",
                        "vd"
                    ],
                    "service_account_scopes": [
                        "https://www.googleapis.com/auth/cloud-platform",
                        "https://www.googleapis.com/auth/cloud.useraccounts.readonly",
                        "https://www.googleapis.com/auth/devstorage.read_write",
                        "https://www.googleapis.com/auth/logging.write"
                    ],
                    "internal_ip_only": false
                },
                "master_config": {
                    "num_instances": 1,
                    "machine_type_uri": "n1-standard-4",
                    "disk_config": {
                        "boot_disk_type": "pd-ssd",
                        "boot_disk_size_gb": 70,
                        "local_ssd_interface": "SCSI"
                    }
                },
                "worker_config": {
                    "num_instances": 2,
                    "machine_type_uri": "n2-standard-2",
                    "disk_config": {
                        "boot_disk_type": "pd-ssd",
                        "boot_disk_size_gb": 90,
                        "local_ssd_interface": "SCSI"
                    }
                },
                "software_config": {
                    "image_version": "{{dataproc_version}}",
                    "properties": {
                        "dataproc:dataproc.conscrypt.provider.enable": "false",
                        "dataproc:pip.packages": "pytz==2025.2, Faker==37.1.0",
                        "spark:spark.dynamicAllocation.enabled": "true",
                        "spark:spark.dynamicAllocation.minExecutors": "1",
                        "spark:spark.dynamicAllocation.maxExecutors": "2",
                        "spark:spark.executor.cores": "1",
                        "spark:spark.executor.memory": "5g",
                        "spark:spark.driver.cores": "2",
                        "spark:spark.driver.memory": "5g",
                        "spark:spark.default.parallelism": "2",
                        "spark:spark.sql.debug.maxToStringFields": "300",
                        "spark:spark.sql.legacy.parquet.datetimeRebaseModeInWrite": "CORRECTED",
                        "hive:hive.optimize.sort.dynamic.partition": "true"
                    },
                    "optional_components": [
                        "JUPYTER",
                        "DELTA"
                    ]
                },
                "lifecycle_config": {
                    "idle_delete_ttl": 0,
                    "auto_delete_ttl": 0
                }
            }
        }
    }
}
